<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NLP Analyzer Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
  <div class="container">
    <a class="navbar-brand fw-semibold text-primary" href="#">NLP Analyzer</a>
    <div class="ms-auto d-flex align-items-center gap-3">
      <span class="text-muted small">Muhammad Shoaib Tahir</span>
      <a href="https://github.com/MuhammadshoaibTahir" target="_blank" class="text-dark fs-5"><i class="fab fa-github"></i></a>
      <a href="https://www.linkedin.com/in/muhammad-shoaib-tahir-3a9103179/" target="_blank" class="text-dark fs-5"><i class="fab fa-linkedin"></i></a>
      <a href="https://mail.google.com/mail/?view=cm&to=shoaibtahir410@gmail.com" target="_blank" class="text-dark fs-5"><i class="fas fa-envelope"></i></a>
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="container py-5">
  <h2 class="text-center mb-4">Text Analysis Tool</h2>
  <form method="POST" class="mb-5">
    <div class="form-floating mb-3">
      <textarea name="text" class="form-control" id="inputText" placeholder="Enter text..." style="height: 150px;" required>{{ text }}</textarea>
      <label for="inputText">Paste your text here...</label>
    </div>
    <div class="text-center">
      <button class="btn btn-success px-4" type="submit"><i class="fas fa-magic me-1"></i> Analyze</button>
    </div>
  </form>

  {% if output %}
  <div class="row gy-4">
    <div class="col-12"><h4>📌 Tokens</h4><p>{{ output.tokens }}</p></div>
    <div class="col-12"><h4>🧠 Lemmatized</h4><p>{{ output.lemmatized }}</p></div>
    <div class="col-12"><h4>🏷️ POS Tags</h4><ul>{% for word, tag in output.pos_tags %}<li>{{ word }} - {{ tag }}</li>{% endfor %}</ul></div>
    <div class="col-12"><h4>🔍 Named Entities</h4><ul>{% for ent, label in output.entities %}<li>{{ ent }} ({{ label }})</li>{% endfor %}</ul></div>
    <div class="col-12"><h4>🌍 Language</h4><p>{{ output.language }}</p></div>
    <div class="col-12"><h4>📝 Summary</h4><p>{{ output.summary }}</p></div>
    <div class="col-12"><h4>📊 Word Frequencies</h4><ul>{% for word, count in output.word_freq %}<li>{{ word }}: {{ count }}</li>{% endfor %}</ul></div>
    <div class="col-12"><h4>📚 Noun Phrases</h4><ul>{% for phrase in output.noun_phrases %}<li>{{ phrase }}</li>{% endfor %}</ul></div>
    <div class="col-12"><h4>🔗 Dependency Parsing</h4><ul>{% for word, dep, head in output.dependencies %}<li>{{ word }} — {{ dep }} → {{ head }}</li>{% endfor %}</ul></div>
    <div class="col-12"><h4>🧩 Dependency Tree</h4><div>{{ output.dep_svg|safe }}</div></div>

    <!-- Sentiment Overview -->
    <div class="col-12">
      <h4>💬 Sentiment Overview</h4>
      <p><strong>Polarity:</strong> {{ output.sentiment.polarity }} |
         <strong>Subjectivity:</strong> {{ output.sentiment.subjectivity }}</p>
    </div>

    <!-- Sentiment Timeline Chart -->
    <div class="col-12">
      <h4>📈 Sentiment Timeline (Sentence-wise)</h4>
      <div class="card shadow-sm p-3">
        <canvas id="sentimentChart" height="300"></canvas>
      </div>
    </div>
    <script>
      const ctx = document.getElementById('sentimentChart');
      const sentimentChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: {{ output.sentence_sentiments | map(attribute='index') | list | tojson }},
          datasets: [
            {
              label: 'Polarity',
              data: {{ output.sentence_sentiments | map(attribute='polarity') | list | tojson }},
              borderColor: 'rgba(75, 192, 192, 1)',
              backgroundColor: 'rgba(75, 192, 192, 0.1)',
              fill: true,
              tension: 0.4
            },
            {
              label: 'Subjectivity',
              data: {{ output.sentence_sentiments | map(attribute='subjectivity') | list | tojson }},
              borderColor: 'rgba(255, 99, 132, 1)',
              backgroundColor: 'rgba(255, 99, 132, 0.1)',
              fill: true,
              tension: 0.4
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: 'Sentiment per Sentence',
              font: { size: 16 }
            }
          },
          scales: {
            y: {
              min: -1,
              max: 1,
              title: { display: true, text: 'Sentiment Score' }
            },
            x: {
              title: { display: true, text: 'Sentence Index' }
            }
          }
        }
      });
    </script>

  </div>
  {% endif %}
</div>
<!-- Footer -->
<footer class="text-center mt-5 border-top py-3 bg-white">
  <div class="container">
    <p>Built by <strong>Muhammad Shoaib Tahir</strong> — NLP Researcher</p>
    <div>
      <a href="https://github.com/MuhammadshoaibTahir" target="_blank" class="me-3"><i class="fab fa-github"></i></a>
      <a href="https://www.linkedin.com/in/muhammad-shoaib-tahir-3a9103179/" target="_blank" class="me-3"><i class="fab fa-linkedin"></i></a>
      <a href="https://mail.google.com/mail/?view=cm&to=shoaibtahir410@gmail.com" target="_blank"><i class="fas fa-envelope"></i></a>
    </div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
